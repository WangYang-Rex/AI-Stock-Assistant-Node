好，**那我们就把「规则型单一股票趋势模型」一次性给你落成「能直接写代码、能进系统、能回测」的版本**。
这套我会按 **A 股实战** + **可解释** 来设计，不玩玄的。

---

# 一、趋势模型的最终输出（先给结论）

```ts
interface TrendResult {
  trend: 'UP' | 'DOWN' | 'SIDEWAYS'
  score: number        // -100 ~ +100
  strength: 'WEAK' | 'MEDIUM' | 'STRONG'
  reasons: string[]    // 告诉你为什么是这个趋势
}
```

---

# 二、核心思想（你一眼就能理解）

> **趋势 = 均线结构 + 动量方向 + 量价确认**

并且：

* **先判断方向**
* **再给强度打分**
* **最后给出可交易结论**

---

# 三、第一层：趋势方向判断（硬规则）

### 1️⃣ 均线多空结构（最核心）

```ts
ma5, ma10, ma20, ma60
```

#### 多头趋势（UP）

```text
MA5 > MA10 > MA20 > MA60
```

#### 空头趋势（DOWN）

```text
MA5 < MA10 < MA20 < MA60
```

#### 否则

```text
SIDEWAYS
```

> 这一条**不满足，后面所有加分统统无效**

---

# 四、第二层：趋势强度打分（-100 ～ +100）

我们用 **打分制**，非常适合进系统、做 UI、做回测。

---

## 1️⃣ 均线差值（最多 ±30 分）

```ts
maDiffScore =
  clamp(((MA10 - MA20) / MA20) * 1000, -30, 30)
```

含义：

* MA10 明显高于 MA20 → 趋势健康
* 越陡 → 趋势越强

---

## 2️⃣ EMA 斜率（最多 ±20 分）

```ts
emaSlope = EMA20(t) - EMA20(t-5)
emaSlopeScore = clamp(emaSlope * 1000, -20, 20)
```

---

## 3️⃣ MACD 动量（最多 ±20 分）

```ts
if (DIF > DEA && MACD_hist > 0) score += 20
if (DIF < DEA && MACD_hist < 0) score -= 20
```

---

## 4️⃣ RSI 状态（最多 ±10 分）

```ts
if (RSI > 55 && RSI < 75) score += 10
if (RSI < 45) score -= 10
```

> ⚠️ RSI > 80 不加分（容易见顶）

---

## 5️⃣ 成交量确认（最多 ±20 分）

```ts
volumeRatio = volume / MA(volume, 20)

if (volumeRatio > 1.2 && close > open) score += 20
if (volumeRatio < 0.8 && close < open) score -= 20
```

---

# 五、第三层：趋势完整判定逻辑

```ts
function calcTrend(result): TrendResult {
  if (!isBullishMA) return DOWN or SIDEWAYS

  totalScore = sum(all scores)

  if (totalScore >= 60) strength = 'STRONG'
  else if (totalScore >= 30) strength = 'MEDIUM'
  else strength = 'WEAK'

  if (totalScore >= 30) trend = 'UP'
  else trend = 'SIDEWAYS'
}
```

---

# 六、完整趋势判断示例（真实可交易）

### 📈 强上涨趋势（最优交易区）

```text
MA5 > MA10 > MA20 > MA60
EMA20 向上
MACD 红柱放大
放量上涨
RSI 60-70
```

```json
{
  "trend": "UP",
  "score": 78,
  "strength": "STRONG",
  "reasons": [
    "均线多头排列",
    "EMA20 上行",
    "MACD 多头动量",
    "放量确认"
  ]
}
```

---

### 🟡 弱趋势（不建议追）

```json
{
  "trend": "SIDEWAYS",
  "score": 18,
  "strength": "WEAK",
  "reasons": [
    "均线未完全多头",
    "量能不足"
  ]
}
```

---

# 七、止损 / 趋势破坏条件（必带）

### ❌ 趋势失效

```ts
if (MA10 < MA20) → 趋势结束
```

### ❌ 强制止损

```ts
if (close < EMA20 - 2 * ATR) → 止损
```

---

# 八、为什么这套模型「真能赚钱」

✅ 不预测价格，只判断方向
✅ 不依赖未来函数
✅ 完全可解释
✅ 非常适合：

* ETF
* 指数
* 大市值股
* 趋势行情

⚠️ **不适合**：

* 纯情绪股
* 连板投机

---

# 九、下一步我可以直接帮你做的事

你现在已经有**完整规则**了，接下来可以直接进入工程阶段：

1️⃣ **我直接给你一份 TypeScript 实现代码（可直接用）**
2️⃣ **帮你把这套趋势模型做成 MySQL 表 + 回测结构**
3️⃣ **接进你现有的 Strategy / 回测引擎**
4️⃣ **给你做一版“趋势 + 买卖点”的完整策略**

你直接选一个编号就行 👇
